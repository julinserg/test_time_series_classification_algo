% Check Hotelling test against known data

temp = load('Testing/swiss.txt');
x = temp(1:100,:);
y = temp(101:200,:);
hotell2(x,y)

% This will not match exactly, since we use the T2-statistic defined by
% Mardia et al.

% From http://sites.stat.psu.edu/~ajw13/stat505/fa06/11_2sampHotel/01_2sampHotel.html
%                   2-Sample Hotellings T2 - Swiss Bank Notes                 20
%                                                   13:41 Tuesday, June 29, 2004
% 
%                                     N1     YBAR1
% 
%                                    100   214.969
%                                          129.943
%                                           129.72
%                                            8.305
%                                           10.168
%                                          141.517
% 
% 
%                                       S1
% 
%          0.1502414 0.0580131 0.0572929 0.0571263 0.0144525 0.0054818
%          0.0580131 0.1325768  0.085899 0.0566515 0.0490667 -0.043062
%          0.0572929  0.085899 0.1262626 0.0581818 0.0306465 -0.023778
%          0.0571263 0.0566515 0.0581818 0.4132071 -0.263475 -0.000187
%          0.0144525 0.0490667 0.0306465 -0.263475 0.4211879 -0.075309
%          0.0054818 -0.043062 -0.023778 -0.000187 -0.075309 0.1998091
% 
% 
%                                     N2     YBAR2
% 
%                                    100   214.823
%                                            130.3
%                                          130.193
%                                            10.53
%                                           11.133
%                                           139.45
% 
% 
%                                       S2
% 
%          0.1240111 0.0315152  0.024001 -0.100596 0.0194354 0.0115657
%          0.0315152 0.0650505 0.0467677  -0.02404 -0.011919 -0.005051
%           0.024001 0.0467677 0.0889404 -0.018576 0.0001323 0.0341919
%          -0.100596  -0.02404 -0.018576 1.2813131 -0.490192 0.2384848
%          0.0194354 -0.011919 0.0001323 -0.490192 0.4044556 -0.022071
%          0.0115657 -0.005051 0.0341919 0.2384848 -0.022071 0.3112121
% 
% 
%                                     SPOOL
% 
%          0.1371263 0.0447641  0.040647 -0.021735 0.0169439 0.0085237
%          0.0447641 0.0988136 0.0663333 0.0163056 0.0185737 -0.024056
%           0.040647 0.0663333 0.1076015  0.019803 0.0153894 0.0052071
%          -0.021735 0.0163056  0.019803 0.8472601 -0.376833  0.119149
%          0.0169439 0.0185737 0.0153894 -0.376833 0.4128217  -0.04869
%          0.0085237 -0.024056 0.0052071  0.119149  -0.04869 0.2555106
%                   2-Sample Hotellings T2 - Swiss Bank Notes                 21
%                                                   13:41 Tuesday, June 29, 2004
% 
%                      T2         F       DF1       DF2         P
% 
%               2412.4507  391.9217         6       193         0

% also try this http://sas-and-r.blogspot.fr/2010/05/example-737-calculation-of-hotellings.html
