clc;
clear;
%%
x_speech = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 660];
y_speech_train_hmm_full_5_0 = [0.900000000000000,0,0,0,0,0.00166666666666667,0,0.00250000000000000,0.00222222222222222,0.00100000000000000,0.0133333333333333,0.00850000000000000,0.00800000000000000,0.0206666666666667,0.0340000000000000,0.0367500000000000,0.0524444444444444,0.0532000000000000,0.0527272727272727,0.0738333333333333,0.0556060606060606];
y_speech_test_hmm_full_5_0 = [0.900000000000000,0.745909090909091,0.491818181818182,0.462727272727273,0.432272727272727,0.410909090909091,0.401363636363636,0.414545454545455,0.387272727272727,0.429545454545455,0.382727272727273,0.349545454545455,0.361818181818182,0.335000000000000,0.186818181818182,0.153636363636364,0.143636363636364,0.125454545454545,0.117272727272727,0.117727272727273,0.0954545454545455];

y_speech_train_hmm_diag_5_0 = [0.900000000000000,0.0150000000000000,0.0133333333333333,0,0.00200000000000000,0.0400000000000000,0.0228571428571429,0.0350000000000000,0.0444444444444444,0.0240000000000000,0.0480000000000000,0.0745000000000000,0.0816000000000000,0.0850000000000000,0.144000000000000,0.148500000000000,0.155777777777778,0.143000000000000,0.157272727272727,0.139500000000000,0.130909090909091];
y_speech_test_hmm_diag_5_0 = [0.900000000000000,0.719090909090909,0.433636363636364,0.409090909090909,0.359545454545455,0.384545454545455,0.405000000000000,0.403636363636364,0.331363636363636,0.384545454545455,0.301363636363636,0.347272727272727,0.334090909090909,0.302727272727273,0.270454545454545,0.233636363636364,0.190000000000000,0.193181818181818,0.158181818181818,0.155909090909091,0.131363636363636];

y_speech_train_hcrf_5_0 = [0.0 0.0 0.0 0.0 0 0.0 0.0 0.0 0.0 0 0.000666666666666667 0.00200000000000000 0.00640000000000000 0.00366666666666667 0.0225714285714286 0.0265000000000000 0.0317777777777778 0.0300000000000000 0.0416363636363636 0.0516666666666667 0.0326153846153846];
y_speech_test_hcrf_5_0 = [0.529090909090909 0.5087 0.4884 0.4681 0.447727272727273 0.4345 0.4212 0.4079 0.3946 0.381363636363636 0.345000000000000 0.328181818181818 0.334090909090909 0.260454545454545 0.168181818181818 0.0881818181818182 0.0936363636363636 0.0872727272727273 0.0713636363636364 0.0627272727272727 0.0722727272727273];

y_speech_train_npmpgm_5_0 = [0.0300000000000000 0.0250000000000000 0.0400000000000000 0.0475000000000000 0.0440000000000000 0.0683333333333333 0.0628571428571429 0.0712500000000000 0.0744444444444444 0.0600000000000000 0.0773333333333333 0.0940000000000000 0.116800000000000 0.114000000000000 0.188571428571429 0.214750000000000 0.216000000000000 0.227200000000000 0.221090909090909 0.213000000000000 0.208333333333333];
y_speech_test_npmpgm_5_0 = [0.511818181818182 0.427727272727273 0.358181818181818 0.305000000000000 0.281818181818182 0.298636363636364 0.302272727272727 0.299545454545455 0.277272727272727 0.277272727272727 0.254090909090909 0.256818181818182 0.262727272727273 0.266818181818182 0.262272727272727 0.253181818181818 0.247272727272727 0.235000000000000 0.215909090909091 0.213181818181818 0.224090909090909];

%%
x_char = [10, 20, 30, 40, 50, 60, 70, 80];
y_char_train_hmm_full_7_0 = [0.0250000000000000,0.0100000000000000,0.0233333333333333,0.0262500000000000,0.0200000000000000,0.0400000000000000,0.0428571428571429,0.0606250000000000];
y_char_test_hmm_full_7_0 = [0.445000000000000,0.325000000000000,0.337500000000000,0.367500000000000,0.215000000000000,0.200000000000000,0.235000000000000,0.140000000000000];
y_char_train_hmm_full_5_0 = [0.0750000000000000 0.0225000000000000 0.0533333333333333 0.0737500000000000 0.0230000000000000 0.0483333333333333 0.0414285714285714 0.0731250000000000];
y_char_test_hmm_full_5_0 = [0.550000000000000 0.492500000000000 0.377500000000000 0.355000000000000 0.370000000000000 0.225000000000000 0.165000000000000 0.102500000000000];
y_char_train_hmm_full_15_3 = [0.0250000000000000,0.0275000000000000,0.0533333333333333,0.0650000000000000,0.0630000000000000,0.0783333333333333,0.0871428571428572,0.0868750000000000];
y_char_test_hmm_full_15_3 = [0.480000000000000,0.362500000000000,0.357500000000000,0.335000000000000,0.342500000000000,0.192500000000000,0.197500000000000,0.117500000000000];
y_char_train_hmm_full_20_3 = [0.0350000000000000,0.0400000000000000,0.0583333333333333,0.0575000000000000,0.0580000000000000,0.0725000000000000,0.0978571428571429,0.0850000000000000];
y_char_test_hmm_full_20_3 = [0.425000000000000,0.337500000000000,0.372500000000000,0.345000000000000,0.340000000000000,0.195000000000000,0.180000000000000,0.115000000000000];

y_char_train_hmm_diag_7_0 = [0.0450000000000000,0.0525000000000000,0.0866666666666667,0.0837500000000000,0.0780000000000000,0.145000000000000,0.178571428571429,0.165625000000000];
y_char_test_hmm_diag_7_0 = [0.450000000000000,0.395000000000000,0.410000000000000,0.402500000000000,0.370000000000000,0.282500000000000,0.290000000000000,0.215000000000000];

y_char_train_hmm_diag_5_0 = [0.155000000000000 0.140000000000000 0.113333333333333 0.122500000000000 0.139000000000000 0.195000000000000 0.186428571428571 0.282500000000000];
y_char_test_hmm_diag_5_0 = [0.570000000000000 0.452500000000000 0.400000000000000 0.525000000000000 0.467500000000000 0.227500000000000 0.292500000000000 0.282500000000000];

y_char_train_hcrf_7_0 = [0 0 0 0 0.00100000000000000 0.00166666666666667 0.00285714285714286 0.00485714285714286];
y_char_test_hcrf_7_0 = [0.432500000000000 0.187500000000000 0.342500000000000 0.277500000000000 0.285000000000000 0.137500000000000 0.110000000000000 0.090000000000000];

y_char_train_hcrf_5_0 = [0 0.00250000000000000 0.00333333333333333 0.0162500000000000 0.00800000000000000 0.0458333333333333 0.0121428571428571 0.0121428571428571];
y_char_test_hcrf_5_0 = [0.405000000000000 0.447500000000000 0.282500000000000 0.360000000000000 0.302500000000000 0.215000000000000 0.102500000000000 0.102500000000000];

y_char_train_npmpgm_7_0 = [0.0550000000000000,0.0725000000000000,0.0700000000000000,0.0875000000000000,0.0770000000000000,0.102500000000000,0.112857142857143,0.112857142857143];
y_char_test_npmpgm_7_0 = [0.385000000000000,0.357500000000000,0.335000000000000,0.342500000000000,0.362500000000000,0.290000000000000,0.217500000000000,0.217500000000000];

y_char_train_npmpgm_5_0 = [0.0300000000000000 0.0550000000000000 0.0650000000000000 0.0637500000000000 0.0850000000000000 0.106666666666667 0.107857142857143 0.126875000000000];
y_char_test_npmpgm_5_0 = [0.360000000000000 0.332500000000000 0.302500000000000 0.302500000000000 0.332500000000000 0.250000000000000 0.225000000000000 0.160000000000000];
%%
x_sensor = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100];
y_sensor_train_hmm_full_6_0 = [0	0	0.0333333333333333	0.0250000000000000	0.0400000000000000	0.0333333333333333	0.0428571428571429	0.0750000000000000	0.0666666666666667	0.0850000000000000];
y_sensor_test_hmm_full_6_0 = [0.544642857142857	0.508928571428571	0.437500000000000	0.339285714285714	0.178571428571429	0.160714285714286	0.401785714285714	0.294642857142857	0.312500000000000	0.0982142857142857];

y_sensor_train_hmm_full_5_0 = [0 0 0.0166666666666667 0.0375000000000000 0.0300000000000000 0.0416666666666667 0.0500000000000000 0.0875000000000000 0.0555555555555556 0.0600000000000000];
y_sensor_test_hmm_full_5_0 = [0.535714285714286 0.517857142857143 0.553571428571429 0.285714285714286 0.232142857142857 0.160714285714286 0.187500000000000 0.321428571428571 0.276785714285714 0.178571428571429];

y_sensor_train_hmm_diag_6_0 = [0	0	0.0500000000000000	0.0375000000000000	0.0400000000000000	0.0416666666666667	0.0571428571428571	0.0812500000000000	0.0722222222222222	0.100000000000000];
y_sensor_test_hmm_diag_6_0 = [0.553571428571429	0.491071428571429	0.410714285714286	0.285714285714286	0.169642857142857	0.169642857142857	0.375000000000000	0.312500000000000	0.241071428571429	0.142857142857143];

y_sensor_train_hmm_diag_5_0 = [0 0 0.0333333333333333 0.0625000000000000 0.0300000000000000 0.0583333333333333 0.0571428571428571 0.106250000000000 0.0777777777777778 0.0800000000000000];
y_sensor_test_hmm_diag_5_0 = [0.517857142857143 0.491071428571429 0.526785714285714 0.258928571428571 0.214285714285714 0.178571428571429 0.214285714285714 0.250000000000000 0.232142857142857 0.214285714285714];

y_sensor_train_hcrf_6_0 = [0	0	0.0333333333333333	0.0375000000000000	0.0200000000000000	0.00833333333333333	0.0214285714285714	0.0375000000000000	0.0388888888888889	0.0350000000000000];
y_sensor_test_hcrf_6_0 = [0.491071428571429	0.473214285714286	0.446428571428571	0.464285714285714	0.205357142857143	0.214285714285714	0.455357142857143	0.303571428571429	0.258928571428571	0.223214285714286];

y_sensor_train_hcrf_5_0 = [0 0 0.0500000000000000 0.0250000000000000 0.0100000000000000 0.00833333333333333 0.0285714285714286 0.0250000000000000 0.0444444444444444 0.0300000000000000];
y_sensor_test_hcrf_5_0 = [0.517857142857143 0.482142857142857 0.464285714285714 0.482142857142857 0.178571428571429 0.205357142857143 0.241071428571429 0.0982142857142857 0.250000000000000 0.232142857142857];

y_sensor_train_npmpgm_6_0 = [0	0.0750000000000000	0.0833333333333333	0.137500000000000	0.130000000000000	0.100000000000000	0.0928571428571429	0.100000000000000	0.0888888888888889	0.0950000000000000];
y_sensor_test_npmpgm_6_0 = [0.419642857142857	0.410714285714286	0.366071428571429	0.133928571428571	0.0803571428571429	0.116071428571429	0.0892857142857143	0.187500000000000	0.178571428571429	0.160714285714286];

y_sensor_train_npmpgm_5_0 = [0.250000000000000 0.125000000000000 0.100000000000000 0.125000000000000 0.110000000000000 0.0916666666666667 0.0857142857142857 0.118750000000000 0.127777777777778 0.125000000000000];
y_sensor_test_npmpgm_5_0 = [0.446428571428571 0.419642857142857 0.357142857142857 0.151785714285714 0.0982142857142857 0.0982142857142857 0.0892857142857143 0.169642857142857 0.160714285714286 0.169642857142857];

%%
x_accelerometer = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100];
y_accelerometer_train_hmm_full_5_2 = [0.116666666666667 0.183333333333333 0.216666666666667 0.229166666666667 0.270000000000000 0.213888888888889 0.209523809523810 0.235416666666667 0.238888888888889 0.228333333333333];
y_accelerometer_test_hmm_full_5_2 = [0.275000000000000 0.266666666666667 0.308333333333333 0.241666666666667 0.308333333333333 0.300000000000000 0.250000000000000 0.316666666666667 0.225000000000000 0.283333333333333];
y_accelerometer_train_hmm_full_20_2 = [0.0833333333333333,0.183333333333333,0.211111111111111,0.245833333333333,0.220000000000000,0.216666666666667,0.192857142857143,0.239583333333333,0.222222222222222,0.221666666666667]; 
y_accelerometer_test_hmm_full_20_2 = [0.258333333333333,0.275000000000000,0.308333333333333,0.283333333333333,0.275000000000000,0.291666666666667,0.216666666666667,0.316666666666667,0.291666666666667,0.283333333333333];
y_accelerometer_train_hmm_full_15_2 = [0.100000000000000,0.183333333333333,0.205555555555556,0.241666666666667,0.220000000000000,0.208333333333333,0.209523809523810,0.239583333333333,0.231481481481481,0.223333333333333];
y_accelerometer_test_hmm_full_15_2 = [0.266666666666667,0.275000000000000,0.300000000000000,0.283333333333333,0.291666666666667,0.283333333333333,0.250000000000000,0.316666666666667,0.300000000000000,0.275000000000000];

y_accelerometer_train_hmm_diag_15_2 = [0.185714285714286 0.285714285714286 0.328571428571429 0.342857142857143 0.334285714285714 0.297619047619048 0.326530612244898 0.355357142857143 0.361904761904762 0.334285714285714];
y_accelerometer_test_hmm_diag_15_2 = [0.392857142857143 0.421428571428571 0.385714285714286 0.264285714285714 0.264285714285714 0.328571428571429 0.371428571428571 0.464285714285714 0.464285714285714 0.464285714285714];

y_accelerometer_train_hcrf_15_0 = [0 0 0 0 0.00666666666666667 0.033333 0.053061  0.025000 0.065079 0.095079];
y_accelerometer_test_hcrf_15_0 = [0.225000000000000 0.250000000000000 0.108333333333333 0.0916666666666667 0.116666666666667 0.121429 0.200000 0.121429 0.235714 0.141429];

y_accelerometer_train_npmpgm_15_0 = [0.0714285714285714 0.121428571428571 0.176190476190476 0.207142857142857 0.214285714285714 0.235714285714286 0.238775510204082 0.232142857142857 0.266666666666667 0.268571428571429];
y_accelerometer_test_npmpgm_15_0 = [0.350000000000000 0.435714285714286 0.371428571428571 0.292857142857143 0.378571428571429 0.378571428571429 0.350000000000000 0.342857142857143 0.342857142857143 0.350000000000000];
y_accelerometer_train_npmpgm_10_0 = [0.0500000000000000 0.166666666666667 0.161111111111111 0.233333333333333 0.220000000000000 0.197222222222222 0.214285714285714 0.216666666666667 0.225925925925926 0.233333333333333];
y_accelerometer_test_npmpgm_10_0 = [0.308333333333333 0.283333333333333 0.316666666666667 0.308333333333333 0.316666666666667 0.233333333333333 0.308333333333333 0.216666666666667 0.275000000000000 0.283333333333333];
y_accelerometer_train_npmpgm_5_0 = [0.0666666666666667 0.250000000000000 0.261111111111111 0.250000000000000 0.256666666666667 0.272222222222222 0.321428571428571 0.314583333333333 0.335185185185185 0.306666666666667];
y_accelerometer_test_npmpgm_5_0 = [0.233333333333333 0.358333333333333 0.366666666666667 0.341666666666667 0.316666666666667 0.350000000000000 0.400000000000000 0.391666666666667 0.400000000000000 0.341666666666667];
y_accelerometer_train_npmpgm_30_0 = [0 0.0416666666666667 0.0666666666666667 0.104166666666667 0.116666666666667 0.0944444444444444 0.0976190476190476 0.127083333333333 0.138888888888889 0.173333333333333];
y_accelerometer_test_npmpgm_30_0 = [0.233333333333333 0.275000000000000 0.266666666666667 0.225000000000000 0.216666666666667 0.183333333333333 0.191666666666667 0.191666666666667 0.150000000000000 0.141666666666667];
%%
TYPE = 2;
%%
if TYPE == 1
    x1 = x_accelerometer;
    y1 = y_accelerometer_train_npmpgm_15_0;
    y2 = y_accelerometer_test_npmpgm_15_0;   
    y3 = 0;
    title('HMM-SSOM');
    set(0,'DefaultAxesFontSize',14,'DefaultAxesFontName','Times New Roman');
    set(0,'DefaultTextFontSize',14,'DefaultTextFontName','Times New Roman');
    %figure('Units', 'normalized', 'OuterPosition', [0 0 1 1]);
    
    hold on;
    grid on;    
    plot(x1, y1,'r','LineWidth',3);
    plot(x1, y2,'--','Color',[.1 .4 .1],'LineWidth',3);
    %plot(x1, repmat(min(y2),size(x1,1),size(x1,2)),'black','LineWidth',1);
    plot(x1, repmat(y3,size(x1,1),size(x1,2)),'-.','Color','black','LineWidth',1);
    axis([min(x1),max(x1),0,0.6])
    legend('Ошибка на обучающей выборке','Ошибка на тестовой выборке');
    BX=get(gca,'XTick');
    BY=get(gca,'YTick');
else
    %title('Spoken Arabic Digit Data Set');    
    %x1 = x_speech;
    %y1 = y_speech_test_hmm_full_5_0;
    %y2 = y_speech_test_hmm_diag_5_0;
    %y3 = y_speech_test_hcrf_5_0;
    %y4 = y_speech_test_npmpgm_5_0;
    %title('Character Trajectories Data Set');
    %x1 = x_char;
    %y1 = y_char_test_hmm_full_7_0;
    %y2 = y_char_test_hmm_diag_7_0;
    %y3 = y_char_test_hcrf_7_0;
    %y4 = y_char_test_npmpgm_7_0;
    %title('Indoor User Movement Prediction from RSS data Data Set');
    %x1 = x_sensor;
    %y1 = y_sensor_test_hmm_full_6_0;
    %y2 = y_sensor_test_hmm_diag_6_0;
    %y3 = y_sensor_test_hcrf_6_0;
    %y4 = y_sensor_test_npmpgm_6_0;
    title('Dataset for ADL Recognition with Wrist-worn Accelerometer Data Set');
    x1 = x_accelerometer;
    y1 = y_accelerometer_test_hmm_full_15_2;
    y2 = y_accelerometer_test_hmm_diag_15_2;
    y3 = y_accelerometer_test_hcrf_15_0;
    y4 = y_accelerometer_test_npmpgm_15_0;
    set(0,'DefaultAxesFontSize',14,'DefaultAxesFontName','Times New Roman');
    set(0,'DefaultTextFontSize',14,'DefaultTextFontName','Times New Roman');
    %figure('Units', 'normalized', 'OuterPosition', [0 0 1 1]);
    %title('Название');
    hold on;
    grid on;    
    plot(x1, y1,'--','Color',[.1 .4 .1],'LineWidth',3);
    plot(x1, y2,'-.','Color',[.8 .6 .1],'LineWidth',3);
    plot(x1, y3,'r','LineWidth',3);
    plot(x1, y4,':','Color',[0 0 1],'LineWidth',3);
    %axis([min(x1),max(x1),0,0.6])
    legend('HMM(Full)','HMM(Diagonal)','HCRF','HMM-SSOM', 1);
    BX=get(gca,'XTick');
    BY=get(gca,'YTick');
    axis auto
    %xlim([0,660])
    %ylim([0,0.6])
    set(gca, 'XTick',0:50:660);
    %xlim([10,80])
    %ylim([0,0.6])
    %set(gca, 'XTick',10:10:80);
    xlim([10,100])
    ylim([0,0.6])
    set(gca, 'XTick',10:10:100);
end;
%%
%xlabel('Количество обучающих данных','Position',[BX(size(BX,2)) BY(1)])
%ylabel('Ошибка классификации','Rotation',0,'Position',[BX(1) BY(size(BY,2))])
% xlabel('Количество обучающих данных')
% ylabel('Ошибка классификации')
% 
% XA=get(gca,'XTickLabel');%
% 
% for i=1:size(XA,1)
% 
%     z=rem(i,2);
%     if z==0;
%         if XA(i,1)~='0' && XA(i,2)~=0
%             XA(i,:)=char(0);
%         end
%     end
%     
% end
% 
% XA(size(XA,1),:)=char(0);
% 
% set(gca,'XTickLabel',XA);
% 
% YA=get(gca,'YTickLabel');%
% 
% for i=1:size(YA,1)
% 
%     z=strfind(YA(i,:),'.');
%     YA(i,z)=',';
%     clear z;
%     z=rem(i,2);
%     if z~=0; 
%         YA(i,:)=char(0);
%     end
%     
% end
% 
% YA(size(YA,1),:)=char(0);
% 
% set(gca,'YTickLabel',YA);

%xlabel('Sample Size');
%ylabel('Error');
